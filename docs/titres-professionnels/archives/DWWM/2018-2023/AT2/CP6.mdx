---
sidebar_position: 6
title: "CP 6"
description: "Synth√®se de la CP 5 \"D√©velopper les composants d'acc√®s aux donn√©es\" du titre professionnel D√©veloppeur Web et Web Mobile (DWWM TP-01280m03, r√©f√©rentiel expir√©)."
---

import Admonition from '@theme/Admonition';

# D√©velopper les composants d'acc√®s aux donn√©es

<Admonition type="warning" title="Attention, tu es en train de consulter un r√©f√©rentiel expir√© !">
  [Aller sur le contenu du nouveau r√©f√©rentiel en vigueur](/titres-professionnels/DWWM/intro)
</Admonition>

## üìö R√©f√©rences

- REAC _(mise √† jour du 27/04/2018)_, pages 23 et 24
- RC _(mise √† jour du 19/04/2018)_, page 11

## üöÄ Contexte

Maintenant que tu connais la structure de ta base de donn√©es et qu'elle est cr√©√©e, il va falloir expliquer comment ton application pourra acc√©der aux donn√©es stock√©es.

En PHP, tu connais certainement `PDO`, mais tu as peut-√™tre √©galement utilis√© un <abbr title="Object-Relational Mapping">ORM</abbr>
comme [Eloquent](https://laravel.com/docs/11.x/eloquent) ou encore [Doctrine](https://symfony.com/doc/current/doctrine.html).

Pour NodeJS, tu as peut-√™tre utilis√© les pilotes [mysql](https://www.npmjs.com/package/mysql), [pg](https://www.npmjs.com/package/pg) ou
[sqlite](https://www.npmjs.com/package/sqlite) pour acc√©der √† ta base de donn√©es ou encore un <abbr title="Object-Relational Mapping">ORM</abbr>
comme [Prisma](https://www.npmjs.com/package/prisma) ou [Sequelize](https://www.npmjs.com/package/sequelize).

L'id√©e ici est d'expliquer comment le back va se connecter √† la base de donn√©es **ET** comment le back est structur√© pour acc√©der aux donn√©es.

Tu vas donc avoir tr√®s certainement avoir besoin de parler des services et des mod√®les qui permettent d'acc√©der aux donn√©es et de les alt√©rer.

Comme cette <abbr title="Comp√©tence Professionnelle">CP</abbr> _(et les suivantes)_ parlent de s√©curit√©,
c'est l'occasion de parler de ton fichier `.env` et du `.gitignore` afin de ne pas avoir de fichiers sensibles dans le repository de ton projet,
dont les informations de connexion √† la base de donn√©es.

<Admonition type="warning" title="Utilisation d'ORM/query builder">
  Si tu utilises un <abbr title="Object-Relational Mapping">ORM</abbr> ou un query builder, il est important de bien expliquer comment tu l'as configur√© et comment tu l'utilises.  
  En plus d'expliquer comment cet outil a √©t√© param√©tr√©, tu dois √™tre en mesure d'expliquer la construction SQL g√©n√©r√©e par cet outil.

  Par exemple avec Prisma :
  ```javascript showLineNumbers
  const user = await prisma.user.findUnique({
      select: {
      id: true,
      name: true,
      email: true,
      posts: {
          select: {
          title: true,
          },
      },
      },
      include: {
      posts: true,
      },
      where: {
      id: 1,
      },
  });
  ```

  Ce qui donnera :
  ```sql
  SELECT u.id, u.name, u.email, p.title -- S√©lection des colonnes
  FROM "User" u -- Table principale
  INNER JOIN "Post" p ON p.userId = u.id -- Jointure avec la table "Post"
  WHERE u.id = 1; -- Condition de s√©lection
  ```

  _(Oui, c'est un exemple fictif et pas enti√®rement correspondant, mais tu as compris l'id√©e !)_
</Admonition> 

On est d'accord : cette <abbr title="Comp√©tence Professionnelle">CP</abbr> est un gros morceau,
mais c'est un passage oblig√© pour bien comprendre comment ton application va interagir avec la base de donn√©es !

## üéØ Crit√®res d'√©valuation

- Les traitements relatifs aux manipulations des donn√©es r√©pondent aux fonctionnalit√©s d√©crites dans le dossier de conception technique
- Un test unitaire est associ√© √† chaque composant, avec une double approche fonctionnelle et s√©curit√©
- Les composants d'acc√®s √† la base de donn√©es suivent les r√®gles de s√©curisation reconnues
- La d√©marche de recherche permet de r√©soudre un probl√®me technique ou de mettre en ≈ìuvre une nouvelle fonctionnalit√©
- La veille sur les vuln√©rabilit√©s connues permet d'identifier des failles potentielles
- La documentation technique li√©e aux technologies associ√©es, r√©dig√©e en langue anglaise, est comprise _(sans contre-sens, ...)_

## ü§Ø Aller plus loin _(hors r√©f√©rentiel)_

### üõ°Ô∏è S√©curisation des donn√©es

J'imagine que dans ton application tu as des donn√©es sensibles, comme des informations personnelles ou encore des mots de passe.  
En ce qui concerne les mots de passe, il est essentiel que ces derniers soient stock√©s de mani√®re s√©curis√©e, c'est-√†-dire **hash√©s**.  
Pour cela, tu peux utiliser des fonctions de hachage comme [bcrypt](https://www.npmjs.com/package/bcrypt) avec NodeJS ou encore [password_hash](https://www.php.net/manual/fr/function.password-hash.php) en PHP.

Pour les informations personnelles, tu as √©galement la possibilit√© de les s√©curiser en les chiffrant !  
Tu peux tr√®s bien te baser sur un algorithme maison ou encore utiliser des biblioth√®ques comme [crypto-js](https://www.npmjs.com/package/crypto-js) en NodeJS ou encore [openssl](https://www.php.net/manual/en/book.openssl.php) en PHP.

### üóëÔ∏è Suppression des donn√©es

<Admonition type="quote" title="Un peu de m√©nage ne fait jamais de mal !">
  On est d'accord ! Cependant, la suppression de donn√©es est une op√©ration d√©licate.  
  Se dire "il suffit de faire un `DELETE FROM table WHERE id = 1`" peut potentiellement poser des probl√®mes.
</Admonition>

En effet, il est important de bien r√©fl√©chir √† la suppression de donn√©es, notamment pour les donn√©es li√©es √† d'autres donn√©es _(les fameux `ON DELETE CASCADE` par exemple)_.

Puisque l'erreur est humaine, permettre la suppression aussi simplement que via un bouton "Supprimer" peut √™tre risqu√©, m√™me si ce dernier est prot√©g√© par un message de confirmation.

On va pr√©f√©rer d'une suppression logique, c'est-√†-dire qu'on va "d√©sactiver" la donn√©e plut√¥t que de la supprimer d√©finitivement.  
C'est ce qu'on appelle plus commun√©ment le **"soft delete"**, l√† o√π la suppression d√©finitive est appel√©e **"hard delete"**.

Il est √©galement important de maintenir un certain √©tat des donn√©es stock√©es, notamment pour des raisons l√©gales ou encore pour des raisons de tra√ßabilit√©.  
Bien entendu, lorsque l'utilisateur souhaite supprimer d√©finitivement ses donn√©es _(<abbr title="R√®glement G√©n√©ral sur la Protection des Donn√©es">RGPD</abbr>)_,
il est important de bien l'informer des cons√©quences de cette action et des d√©lais de suppression dans la politique de confidentialit√© de ton application.
