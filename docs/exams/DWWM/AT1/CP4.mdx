---
sidebar_position: 4
title: "CP 4"
---

import Admonition from "@theme/Admonition";
import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";

# D√©velopper la partie dynamique des interfaces utilisateur web ou web mobile

## üìö R√©f√©rences

- REAC _(mise √† jour du 03/07/2024)_, pages 21 et 22
- RE _(mise √† jour du 03/07/2024)_, page 10

## üìã En r√©sum√©

√áa y est, on commence √† parler d√©veloppement pour de vrai maintenant ! On quitte doucement l'int√©gration pour maintenant rajouter de l'interactivit√© √† nos interfaces utilisateur, ce qui veut dire "utilisation d'un langage script c√¥t√© client", soit...

<iframe
  src="https://giphy.com/embed/SvFocn0wNMx0iv2rYz"
  width="480"
  height="480"
  frameBorder="0"
  class="mx-auto my-4"
></iframe>

C'est le meilleur moment pour parler de nombreuses fonctionnalit√©s impl√©ment√©es sur ton application avec Javascript, comme :

- Les formulaires dynamiques _(ajout/suppression de champs, v√©rification des donn√©es, etc.)_
- Les animations _(chargement d'un t√©moin de chargement, apparition/disparition d'√©l√©ments, etc.)_
- Les interactions avec l'utilisateur _(drag and drop, ouverture de fen√™tre modale, etc.)_
- Les appels √† des services web _(API REST, etc.)_

<Admonition type="warning" title="Consommation d'API">
Bien que j'ai mentionn√© le fait que faire des appels √† des services web corresponde enti√®rement √† cette CP, il est important de noter que la consommation d'API est une comp√©tence √† part enti√®re, qui sera abord√©e dans la CP 7 qui correspond √† la mise en place de services web et composants m√©tier.

Ne te focalise donc pas sur ce que fait l'API en arri√®re plan, concentre toi sur comment configurer tes requ√™tes et comment traiter les r√©ponses obtenues !

</Admonition>

<Admonition type="tip" title="Mon site est fait avec React/Angular/Vue.js, donc je valide automatiquement cette CP ?" icon="ü§î">
Pas si vite ! üòè  
Effectivement, ton site r√©pond _(en th√©orie)_ en tous points pour la comp√©tence actuelle, mais il est important de montrer que tu sais comment fonctionne le Javascript "vanilla" _(c'est-√†-dire sans framework ou biblioth√®que)_.

Si tu as utilis√© un framework, tu peux tout √† fait montrer des extraits de code en Javascript pur pour montrer que tu sais comment √ßa fonctionne "sous le capot" !

Mais on ne va pas se le cacher, si tu as r√©ussi √† r√©aliser un projet avec un framework, c'est d√©j√† un tr√®s bon point pour toi qui permet de d√©montrer que tu as de bonnes connaissances en Javascript.  
Cependant il va potentiellement y avoir un d√©faut majeur sur ton projet : le r√©f√©rencement naturel _(SEO)_.

</Admonition>

<Admonition type="info" title="R√©f√©rencement d'un site g√©n√©r√© c√¥t√© client _(comme React, Vue.js etc)_">
Les sites web g√©n√©r√©s c√¥t√© client _(ou "client-side rendering")_ ont un d√©faut majeur : ils ne sont pas tr√®s bien r√©f√©renc√©s par les moteurs de recherche.

En effet, les moteurs de recherche ont du mal √† lire le contenu d'un site g√©n√©r√© c√¥t√© client, car ils n'ex√©cutent pas le Javascript.  
C'est pour cela qu'il est recommand√© de mettre en place un rendu c√¥t√© serveur _(ou "server-side rendering")_ pour am√©liorer le r√©f√©rencement naturel de ton site.

Si tu veux en savoir plus sur le sujet, tu peux consulter [cet article de Google](https://web.dev/articles/rendering-on-the-web?hl=fr#rendering-terminology).

De mon c√¥t√©, je recommande √©norm√©ment de passer par le framework [Vike](https://vike.dev/) qui permet de g√©n√©rer des sites web ultra-rapides avec un rendu c√¥t√© serveur et un rendu c√¥t√© client, le tout en utilisant Vue.js, React ou (presque) n'importe quel autre framework front-end Javascript !

Tu as aussi la possibilit√© d'utiliser [Next.js](https://nextjs.org/) pour React, [Nuxt.js](https://nuxtjs.org/) pour Vue.js ou [SvelteKit](https://kit.svelte.dev/) pour Svelte qui permettent de faire du rendu c√¥t√© serveur.

</Admonition>

## ‚ûï Informations compl√©mentaires

Je me permets √©galement de l√¢cher une bombe sur une certaine techno JS : **jQuery**.  
Bon sang, celui-l√† il me fait penser √† un vieux pote qui a pris un coup de vieux... üòÖ

<Admonition type="tip" icon="ü§î" title="jQuery, c'est quoi ?">
jQuery est une biblioth√®que Javascript qui a √©t√© tr√®s populaire dans les ann√©es 2000 et 2010.
Elle a √©t√© cr√©√©e pour simplifier l'√©criture de scripts Javascript et pour faciliter la manipulation du DOM.

jQuery a √©t√© tr√®s utilis√©e pour les animations, les requ√™tes AJAX, la manipulation du DOM, etc.
Mais depuis l'arriv√©e des frameworks front-end comme React, Angular ou Vue.js, jQuery a perdu de sa superbe et est de moins en moins utilis√©e.

Cependant, il est toujours bon de conna√Ætre jQuery, car il est possible que tu tombes sur un projet qui l'utilise encore, comme sur des templates Wordpress qui commencent √† dater par exemple.

</Admonition>

Mais alors, pourquoi je te parle de jQuery ?

Eh bien.. pour faire simple, aujourd'hui jQuery est relativement obsol√®te et surtout tr√®s lourd pour ce que √ßa rajoute √† un projet.  
Dans la mesure du possible, il est recommand√© de ne pas utiliser jQuery pour un nouveau projet, et de pr√©f√©rer Javascript "vanilla" ou un framework ou biblioth√®que front-end comme React, Angular ou Vue.js _(attention, d'un point de vue √©co-conception l'utilisation d'un framework n'est pas forc√©ment la meilleure solution)_.

<Admonition type="tip" icon="üò±" title="Mais comment je vais faire pour mes consommations d'API, vu que j'utilisais `jQuery.ajax()` ?!">
  Tout doux, tout doux, il existe une solution ! üòé

Si je te parle des requ√™tes XHR _(XMLHttpRequest)_ tu me dis... ?

> "Mais c'est vieux √ßa, c'est pas du tout √† la mode !"

Et tu as raison, mais si maintenant je te dis qu'il y a une autre solution, native, plus moderne et plus performante, tu me dis... ?

> "Fetch !"

**Et sinon, pour faire simple :**

Fetch est une API plus moderne et plus simple √† utiliser que les requ√™tes XHR, et elle est support√©e par tous les navigateurs modernes.  
 Elle permet de faire des requ√™tes HTTP de mani√®re asynchrone et de g√©rer les r√©ponses de mani√®re plus simple.

<Tabs>
  <TabItem value="XHR">

```javascript showLineNumbers
const xhr = new XMLHttpRequest();
xhr.open("GET", "https://api.exemple.com/data", true);
xhr.onreadystatechange = function () {
  if (xhr.readyState === 4 && xhr.status === 200) {
    console.log(JSON.parse(xhr.responseText));
  }
};
xhr.send();
```

  </TabItem>

<TabItem value="jQuery">

```javascript showLineNumbers
$.ajax({
  url: "https://api.exemple.com/data",
  method: "GET",
  success: function (data) {
    console.log(data);
  },
});
```

</TabItem>

<TabItem value="Fetch">

```javascript showLineNumbers
fetch("https://api.exemple.com/data")
  .then((response) => response.json())
  .then((data) => console.log(data));
```

</TabItem>
</Tabs>

Non seulement `fetch` est plus simple √† utiliser et comprendre _(contrairement √† XMLHttpRequest)_ mais elle est √©galement plus l√©g√®re que `jQuery.ajax()` puisqu'elle est native au navigateur ! Alors pourquoi s'en priver ? üòâ

</Admonition>

## üéØ Crit√®res d'√©valuation

- L‚Äôinterface utilisateur est conforme au dossier de conception
- L‚Äôinterface est dynamique et l‚Äôexp√©rience utilisateur est am√©lior√©e, y compris pour les personnes en situation de handicap
- Les recommandations de s√©curit√© li√©es aux applications web et web mobile sont respect√©es
- La r√®glementation en vigueur sont respect√©es, y compris celle relative √† l‚Äôaccessibilit√©
- Le code est document√©, y compris en anglais _(niveau B1 CECRL pour l‚Äôanglais)_
- Le jeu d‚Äôessai fonctionnel est complet et les tests unitaires sont r√©alis√©s pour les composants concern√©s
- Les tests de s√©curit√© sont r√©alis√©s

## ü§Ø Aller plus loin _(hors r√©f√©rentiel)_

Plus t√¥t, dans la CP 3, je t'ai parl√© d'une astuce d'√©co-conception pour diff√©rer le chargement des images avec l'attribut `loading="lazy"` sur les balises `<img>`. Mais on peut aller encore plus loin que simplement diff√©rer le chargement des images !

On peut √©galement diff√©rer le chargement des scripts Javascript avec l'attribut defer sur les balises `<script>`.

<Admonition type="tip" title="`defer` sur les balises `<script>`">
Si √ßa te rassure, √ßa ne cassera pas ton site web et au contraire, √ßa peut m√™me l'am√©liorer !
L'int√©r√™t premier de cet attribut est de diff√©rer l'ex√©cution du script jusqu'√† ce que le document HTML soit enti√®rement charg√©.

L'avantage de cette technique est qu'on va demander au navigateur de charger le script en parall√®le du reste du contenu, sans bloquer le chargement de la page.
Comme √ßa : pas de page blanche pendant le chargement du script, et le script sera ex√©cut√© une fois que le navigateur aura fini de charger le reste de la page !

```html
<script src="script.js" defer></script>
```

</Admonition>

Maintenant, on sait qu'on peut charger de mani√®re "asynchrone" nos images et nos scripts, mais ce n'est toujours pas termin√©.. üòè

Prenons l'exemple d'un site qui incorpore plusieurs dizaines de vid√©os Youtube sur une seule page. On aura donc des `<iframe>` qui vont charger des vid√©os Youtube, et √ßa, c'est pas tr√®s √©co-responsable... üòï
Mais on peut am√©liorer notre page en mettant en place une l√©g√®re interaction Javascript pour charger l'iframe uniquement si l'utilisateur clique sur un bouton !

<Tabs>
<TabItem value="HTML - 1√®re √©tape">
```html showLineNumbers
<div
class="iframe-container"
data-src="https://www.youtube.com/watch?v=dQw4w9WgXcQ"
data-width="1280"
data-height="720"
>
  <img src="https://img.youtube.com/vi/dQw4w9WgXcQ/maxresdefault.jpg" loading="lazy">
  <button type="button" class="iframe-loader">Charger la vid√©o</button>
</div>
```
</TabItem>

<TabItem value="Javascript - 2√®me √©tape">

```javascript showLineNumbers
document.querySelectorAll('button.iframe-loader').forEach((button: HTMLButtonElement) => {
  // Pour chaque bouton qui doit charger un iframe, on √©coute le clic dessus
  button.addEventListener('click', () => {
      // On r√©cup√®re le container de l'iframe, qui dans notre exemple est la balise parente du bouton
      const container: HTMLElement | null = button.closest('.iframe-container');

      // Si le container n'existe pas, on arr√™te l'ex√©cution de la fonction pour √©viter un plantage
      if (!container) return;

      const { src, width, height } = container.dataset as {
          src: string,
          width: string,
          height: string
      };

      // On pr√©pare notre iframe avec les donn√©es stock√©es dans le container
      const iframe = document.createElement('iframe');
      iframe.setAttribute('src', src);
      iframe.setAttribute('width', width);
      iframe.setAttribute('height', height);

      // On supprime le contenu du container pour y ajouter notre iframe
      container.innerHTML = '';
      container.appendChild(iframe);
  });

});

```

</TabItem>
</Tabs>

<Admonition type="tip" icon="ü§î" title="Mais √ßa fait beaucoup de code juste pour charger des iframes, c'est vraiment n√©cessaire ?">
Pour √™tre franc, il n'y a pas de solution id√©ale. Mais on peut am√©liorer les performances du site et gagner en sobri√©t√© num√©rique en ne chargeant pas des ressources lourdes inutilement.

Est-ce que tu savais que le simple fait de charger un iframe d'une vid√©o Youtube demande au navigateur de faire une dizaine de requ√™tes HTTP pour charger la vid√©o, les scripts et les styles de Youtube ? Imagine si on mixe plusieurs sources pour nos iframes, comme Dailymotion, Vimeo, etc. üò±

Et le pire dans tout √ßa, c'est que le navigateur va charger ces ressources m√™me si l'utilisateur ne comptait pas regarder la vid√©o !
Alors autant faire en sorte que notre site r√©ponde au besoin de l'utilisateur, sans pour autant supprimer les fonctionnalit√©s _(comme nos iframes)_ qui peuvent √™tre utiles.

</Admonition>

---

## üß† Documentations

- [MDN Web Docs - Attribut `loading` sur les balises `<img>`](https://developer.mozilla.org/fr/docs/Web/HTML/Element/img#loading)
- [MDN Web Docs - Attribut `defer` sur les balises `<script>`](https://developer.mozilla.org/fr/docs/Web/HTML/Element/script#defer)
- [MDN Web Docs - Attribut `data-*`](https://developer.mozilla.org/fr/docs/Web/HTML/Global_attributes/data-*)
- [MDN Web Docs - `fetch`](https://developer.mozilla.org/fr/docs/Web/API/Fetch_API)
- [Wikip√©dia - API](https://fr.wikipedia.org/wiki/Interface_de_programmation)

## üõ†Ô∏è Outils

- [Vike - Framework front-end pour un rendu c√¥t√© serveur et c√¥t√© client](https://vike.dev/)
- [Next.js - Framework pour React avec rendu c√¥t√© serveur](https://nextjs.org/)
- [Nuxt.js - Framework pour Vue.js avec rendu c√¥t√© serveur](https://nuxtjs.org/)
- [SvelteKit - Framework pour Svelte avec rendu c√¥t√© serveur](https://kit.svelte.dev/)
